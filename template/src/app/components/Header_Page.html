<script>
  import { getState, updateState } from "wivex"

  document.querySelector("[data-btn-menu]").addEventListener("click", () => {
    const state = getState("HeaderPage");
    updateState("HeaderPage", { menu: state.menu === "open" ? "" : "open" });
  });

  document.querySelector(".menu").addEventListener("click", () => {
    const state = getState("HeaderPage");
    updateState("HeaderPage", { menu: "" });
  })
</script>

<header>
  <div class="container">
    <a href="/" aria-label="Go to the beginning">
      <img src="/assets/img/logo.png" alt="Logo">
      <TitleLib></TitleLib>
    </a>
    <nav>
      <button aria-label="Open menu" class="btn" data-btn-menu><i class="wi wi-bars"></i></button>
      <div class="menu {menu}">
        <a href="/" aria-label="Go to the beginning">Home</a>
        <a href="/about" aria-label="Go to Contact">About</a>
        <DarkToggle></DarkToggle>
      </div>
    </nav>
  </div>
</header>

<style>
  :root {
    --wipo-background-default: var(--pico-background-color);
  }

  body>header {
    --pico-block-spacing-vertical: 0;
    position: sticky;
    top: 0;
    z-index: 9999;
    background-color: var(--pico-background-color);
    border-bottom: 1px solid var(--pico-form-element-border-color);

    .container {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: .5rem var(--pico-spacing);
      gap: var(--pico-spacing);

      &>a {
        display: flex;
        align-items: center;
        text-decoration: none;
        gap: var(--pico-spacing);

        h2 {
          margin-bottom: 0;
        }
      }

      &>nav {
        display: flex;
        align-items: center;

        .btn {
          display: flex;
          color: var(--pico-primary);
          background-color: transparent;
          padding: 0;
          border: none;
          border-radius: 0;
          font-size: 1.2rem;

          &:is(:hover, :focus) {
            --pico-box-shadow: none;
          }

          &[data-btn-menu] {
            font-size: 2rem;
          }

          @media (min-width: 768px) {
            &[data-btn-menu] {
              display: none;
            }
          }
        }

        .menu {
          display: none;
          top: -100%;
          transition: top var(--pico-transition);

          a,
          button {
            text-decoration: none;
            padding: var(--pico-spacing);
            background-color: var(--wipo-background-default);
            border-bottom: var(--pico-border-width) solid var(--pico-form-element-border-color);

            &:is(:hover, :focus) {
              text-decoration: none;
              background-color: var(--pico-primary);
              color: var(--pico-primary-inverse);
            }

            @media (min-width: 768px) {
              & {
                border-bottom: none;
                padding: 0.5rem 1rem;
                background-color: transparent;
              }

              &:is(:hover, :focus) {
                text-decoration: underline;
                color: var(--pico-primary);
                background-color: transparent;
                text-underline-offset: 4px;
              }
            }
          }

          [data-theme-toggle] {
            display: flex;
            align-items: center;
            gap: var(--pico-spacing);
          }

          @media (min-width: 768px) {
            [data-theme-toggle] span {
              display: none;
            }
          }
        }

        div.open {
          display: flex;
          flex-direction: column;
          position: absolute;
          top: calc(100% + var(--pico-border-width));
          left: 0;
          width: 100%;
          z-index: 1;
        }

        @media (min-width: 768px) {
          div.menu {
            display: flex;
            flex-direction: row;
            position: static;
            align-items: center;
          }
        }
      }
    }


  }
</style>